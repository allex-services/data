!function(a,b,c){a.factory("allex.data.sinkFactory",[function(){function a(a){f.call(this),a||(a={}),this.sinkPath=null,this.sinkData=null,this.user=a.user,this._mgl=null,this.recordDescriptorTranslator=a.recordDescriptorTranslator||b.dummyFunc,this._onUpdateCB=a.onUpdate||b.dummyFunc,this.config=a,this._user_state_l=this.user.attachListener("state",this._onUserStateChanged.bind(this))}function d(b){a.call(this,b)}function e(b){a.call(this,b),this.propertyhash=b.propertyhash,this._dataCbs=b.dataCallBacks}var f=b.CLDestroyable,g=c.execSuite.taskRegistry;return b.inherit(a,f),a.prototype.__cleanUp=function(){this.config=null,this._user_state_l&&this._user_state_l.destroy(),this._user_state_l=null,this._mgl&&this._mgl.destroy(),this._mgl=null,this.user=null,this.sinkData=null,this.sinkPath=null,this._onUpdateCB=null,this.recordDescriptorTranslator=null,f.prototype.__cleanUp.call(this)},a.prototype._onUserStateChanged=function(a){this._createSink()},a.prototype.set_sinkPath=function(a){this.sinkPath=a,this._createSink()},a.prototype.set_sink=function(a){this._mgl&&this._mgl.destroy(),this._mgl=null,a&&(this.set("sinkData",a.data),this._mgl=a.monitorDataForGui(this._onUpdateCB),this.recordDescriptorTranslator(a.recordDescriptor)),this._onUpdateCB()},b.inherit(d,a),d.prototype.__cleanUp=function(){a.prototype.__cleanUp.call(this)},d.prototype._createSink=function(){var a=this.get("sinkPath");a?this.set("sink",this.get("user").getSubSink(a)||null):this.set("sink",null)},b.inherit(e,a),e.prototype.__cleanUp=function(){this._dataCbs=null,this.propertyhash=null,a.prototype.__cleanUp.call(this)},e.prototype._createSink=function(){var a=this.get("sinkPath");a&&this.get("user").execute("askForRemote",a).done(this._doConnect.bind(this),this._remoteFailed.bind(this))},e.prototype._remoteFailed=function(){},e.prototype._doConnect=function(){g.run("acquireSubSinks",{state:g.run("materializeState",{sink:this.get("user").get("user_sink")}),subinits:[{name:this.get("sinkPath"),identity:{role:this.get("user").get("role")},propertyhash:this.get("propertyhash")||{},cb:this.set.bind(this,"sink")}]})},e.prototype.set_sink=function(b){if(b){var c=this.config;g.run("materializeData",{sink:b,data:this.sinkData,onInitiated:c.onInitiated,onRecordCreation:c.onRecordCreation,onDelete:c.onDelete,onNewRecord:c.onNewRecord,onRecordDeletion:c.onRecordDeletion,onUpdate:c.onUpdate,onRecordUpdate:c.onRecordUpdate})}a.prototype.set_sink.call(this,b)},function(a,b){if("dynamic"!==a&&"static"!==a)throw new Error("Unknown sink type: "+a);return"dynamic"===a?new e(b):new d(b)}}]),a.factory("allex.data.ViewSetUp",[function(){return function(a,b){if(!a)throw new Error("No sink given");if(!b)throw new Error("No view given");if(!ALLEX_CONFIGURATION.VIEWS[a])throw new Error("No view configuration for sink "+a);if(!ALLEX_CONFIGURATION.VIEWS[a][b])throw new Error("No view configuration for sink "+b);return{sink_type:ALLEX_CONFIGURATION.VIEWS[a].sink_type,view:ALLEX_CONFIGURATION.VIEWS[a][b]}}}])}(angular.module("allex.data",["allex.lib","ui.grid","ui.grid.autoResize"]),ALLEX.lib,ALLEX),function(a,b,c){a.factory("allex.data.GridMixIn",["$compile",function(a){function c(a,b,c){c=c||{},this.gridOptions=angular.extend({},d,b),this.gridOptions.data=c.dataPath,this.renderer='<div class="grid_container" ui-grid="_ctrl.gridOptions"></div>',this.autoresize=c.autoresize||!0,this._ready=!1}var d={enableSorting:!1,minimumColumnSize:150};return c.prototype.__cleanUp=function(){this.renderer=null,this.autoresize=null,this.gridOptions=null,this._ready=null},c.addMethods=function(a){b.inheritMethods(a,c,"set_el","_doRender","set_record_descriptor","set_auto_resize","set_subsinksPath")},c.prototype.set_auto_resize=function(a){this.autoresize=a,this._doRender()},c.prototype.set_el=function(a){this.el=a,this._doRender()},c.prototype.set_record_descriptor=function(a){this.gridOptions.columnDefs=this.produceColumnDefs(a),this._ready=!0,this._doRender()},c.prototype._doRender=function(){if(this._ready&&this.el){this.el.empty();var b=$(this.renderer);this.autoresize&&b.attr("ui-grid-auto-resize",""),this.el.append(b),a(this.el.contents())(this.scope)}},c}]),a.directive("allexDataGrid",[function(){return{restrict:"E",transclude:!0,replace:!0,template:'<div class="allexdatagrid"></div>',link:function(a,b){a._ctrl.set("el",b)}}}])}(angular.module("allex.data"),ALLEX.lib,ALLEX),function(a,b,c){a.factory("allex.data.TreeMixIn",["allex.data.DataMonitorMixIn",function(a){function c(b,c,e){this.treeConfig=angular.extend({},d,c),this.treeInstance=null,this.treeData=null,a.call(this,b,e)}var d={core:{multiple:!1,animation:!0,error:function(a){log.error("treeCtrl: error from js tree - "+angular.toJson(a))},check_callback:!0,worker:!0},types:{"default":{icon:"glyphicon glyphicon-flash"},star:{icon:"glyphicon glyphicon-star"},cloud:{icon:"glyphicon glyphicon-cloud"}},version:1,plugins:["types","checkbox"]};return c.prototype.__cleanUp=function(){this.treeConfig=null,this.treeInstance=null,this.treeData=null,a.prototype.__cleanUp.call(this)},c.addMethods=function(d){a.addMethods(d),b.inheritMethods(d,c,"_onTreeReady","_onTreeNodeCreated","_reprocessStructure")},c.prototype._onTreeReady=function(){},c.prototype._onTreeNodeCreated=function(){},c.prototype._reprocessStructure=function(){},c}]),a.directive("allexTree",function(){return{restrict:"E",replace:!0,template:'<div js-tree="_ctrl.treeConfig", ng-model="_ctrl.treeData" tree="_ctrl.treeInstance" tree-events="ready:_ctrl._onTreeReady; create_node:_ctrl._onTreeNodeCreated"></div>'}})}(angular.module("allex.data"),ALLEX.lib,ALLEX),function(a,b,c){c.execSuite.taskRegistry;a.factory("allex.data.Views",["allex.data.ViewSetUp","allex.AllexViewChild","allex.lib.UserDependentMixIn","allex.data.sinkFactory","allex.data.GridMixIn",function(a,c,d,e,f){function g(g){b.BasicController.call(this,g),c.call(this,g),d.call(this,g);var h=this.get("data");this.view_setup=a(h.sink,h.view),this.sink_wrapper=e(this.view_setup.sink_type,{user:this.get("user"),onUpdate:this._onUpdate.bind(this)}),f.call(this,g,this.view_setup.view.grid,this.view_setup.view.config),this.sink_wrapper.set("sinkPath",h.sink)}return b.inherit(g,b.BasicController),c.addMethods(g),d.addMethods(g),f.addMethods(g),g.prototype.__cleanUp=function(){this.sink_wrapper.destroy(),this.sink_wrapper=null,this.view_setup=null,d.prototype.__cleanUp.call(this),c.prototype.__cleanUp.call(this),f.prototype.__cleanUp.call(this),b.BasicController.prototype.__cleanUp.call(this)},g.prototype._onUpdate=function(){this.$apply(),console.log("AJ DA TE VIDIM ...")},{Table:g}}]),a.controller("allex.data.ViewsController",["$scope","allex.data.Views",function(a,b){new b.Table(a)}]),a.config(["allex.PageRouterProvider",function(a){a.router.setAlias("partials/allex_dataservice/partials/crudtableview.html","table_cruds")}])}(angular.module("allex.data"),ALLEX.lib,ALLEX);